<?xml version="1.0" encoding="UTF-8"?>
<process name="RollbackLocalErrorHandlerTest" display-name="Rollback local error handler test" item-type="Process" type="TopLevel" skin-name="uml" node-geometry="size:320:120"><description>Test case for rollback behavior within the activity.</description><generator-info><![CDATA[
<generator-settings generator-name="ProcessTopLevel"/>
]]></generator-info><activity-node name="CreateException" display-name="Cause an exception here"><geometry>origin:227:667|size:160:60</geometry><socket name="Error"><geometry>angle:0.0</geometry></socket><socket name="In" entry="true" default="true"><geometry>angle:4.71238898038469</geometry></socket><socket name="Out" default="true"><geometry>angle:1.5707963267948966</geometry></socket><activity-handler><script>throw new java.lang.RuntimeException(&quot;This is a test exception&quot;);</script></activity-handler></activity-node><activity-node name="CreateList" display-name="Create list (&quot;1&quot;, &quot;2&quot;, &quot;3&quot;)"><geometry>origin:227:266|size:160:60</geometry><socket name="In" entry="true" default="true"><geometry>angle:4.71238898038469</geometry></socket><socket name="Out" default="true"><geometry>angle:1.5707963267948966</geometry></socket><activity-handler><script>java.util.ArrayList l = new java.util.ArrayList();\nl.add(&quot;1&quot;);\nl.add(&quot;2&quot;);\nl.add(&quot;3&quot;);\n_GlobalList = l;</script></activity-handler></activity-node><activity-node name="CreateUnrecoverableException" display-name="Cause an unrecoverable exception here"><geometry>origin:556:461|size:278:56</geometry><socket name="In" entry="true" default="true"><param name="ListArg" type="Object" optional="true"/><geometry>angle:1.5707963267948966</geometry></socket><socket name="Out" default="true"><geometry>angle:4.71238898038469</geometry></socket><activity-handler><script>throw new org.openbp.core.engine.EngineException(&quot;FailedTestCase&quot;, &quot;Size of list is not 3, list = &quot; + ListArg.toString());</script></activity-handler></activity-node><decision-node name="Decision3" expression="ListArg.size() == 3"><geometry>origin:556:667|size:60|nameangle:1.5707963267948966</geometry><socket name="In" entry="true" default="true"><param name="ListArg" type="Object" optional="true"/><geometry>angle:3.141592653589793</geometry></socket><socket name="No"><geometry>angle:4.71238898038469</geometry></socket><socket name="Yes" default="true"><geometry>angle:0.0</geometry></socket></decision-node><final-node name="Out"><geometry>origin:895:667|size:35</geometry><socket name="In" entry="true" default="true"><geometry>angle:3.141592653589793</geometry></socket></final-node><final-node name="Out3"><geometry>origin:227:839|size:35</geometry><socket name="In" entry="true" default="true"><geometry>angle:4.71238898038469</geometry></socket></final-node><final-node name="Out4"><geometry>origin:556:300|size:35</geometry><socket name="In" entry="true" default="true"><geometry>angle:1.5707963267948966</geometry></socket></final-node><activity-node name="RemoveFirstElementFromList" display-name="Remove first element from list"><geometry>origin:227:495|size:226:54</geometry><socket name="In" entry="true" default="true"><param name="ListArg" type="Object" optional="true"/><geometry>angle:4.71238898038469</geometry></socket><socket name="Out" default="true"><param name="ListArg" type="Object" optional="true"/><geometry>angle:1.5707963267948966</geometry></socket><activity-handler><script>ListArg.remove(0);</script></activity-handler></activity-node><initial-node name="Start"><geometry>origin:227:86|size:35</geometry><socket name="Out" default="true"><geometry>angle:1.5707963267948966</geometry></socket></initial-node><control-link name="ControlLink" source="Start.Out" target="CreateList.In"><geometry>points:1:227:126:227:153:227:204:227:237|label:0:0|factors:0.3:0.3</geometry></control-link><control-link name="ControlLink19" source="CreateList.Out" target="RemoveFirstElementFromList.In" transaction-control="commit"><geometry>points:1:227:295:227:340:227:400:227:445|label:0:0|factors:0.3:0.3</geometry></control-link><control-link name="ControlLink20" source="RemoveFirstElementFromList.Out" target="CreateException.In"><geometry>points:1:227:545:227:566:227:610:227:638|label:0:0|factors:0.3:0.3</geometry></control-link><control-link name="ControlLink21" source="CreateException.Error" target="Decision3.In"><geometry>points:1:345:667:383:667:448:667:492:667|label:0:0|factors:0.3:0.3</geometry></control-link><control-link name="ControlLink22" source="Decision3.No" target="CreateUnrecoverableException.In"><geometry>points:1:556:613:556:583:556:542:556:512|label:0:0|factors:0.3:0.3</geometry></control-link><control-link name="ControlLink23" source="CreateException.Out" target="Out3.In"><geometry>points:1:227:696:227:734:227:784:227:822|label:0:0|factors:0.3:0.3</geometry></control-link><control-link name="ControlLink24" source="CreateUnrecoverableException.Out" target="Out4.In"><geometry>points:1:556:434:556:399:556:353:556:318|label:0:0|factors:0.3:0.3</geometry></control-link><control-link name="ControlLink25" source="Decision3.Yes" target="Out.In"><geometry>points:1:621:667:698:667:801:667:878:667|label:0:0|factors:0.3:0.3</geometry></control-link><data-link name="DataLink" source="_GlobalList" target="CreateUnrecoverableException.In.ListArg"/><data-link name="DataLink2" source="_GlobalList" target="RemoveFirstElementFromList.In.ListArg"/><data-link name="DataLink3" source="RemoveFirstElementFromList.Out.ListArg" target="_GlobalList"/><data-link name="DataLink4" source="_GlobalList" target="Decision3.In.ListArg"/><process-variable name="GlobalList" display-name="Global list" type="Object" scope="subprocess" persistent="true"/><text-element name="Text" geometry="rect:254:729:535:48"><description>The exception is caught in the TokenContext's local error event handler,\nwhich will perform a rollback with parameter RollbackDataBehavior.RESTORE_VARIABLES mode.\nThe handler will cause the engine to continue at the error socket.</description></text-element></process>